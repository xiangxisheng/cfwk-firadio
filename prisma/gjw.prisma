generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "sqlite"
  url      = "file:./gjw.db"
}

// 语言包
model pre_system_i18n_data {
  id           Int    @id @default(autoincrement())
  created      Int
  updated      Int?
  group        String
  name         String
  locale_en_us String
  locale_zh_cn String
  locale_km_kh String

  @@unique([group, name])
}

// 系统用户
model pre_system_users {
  id       Int    @id @default(autoincrement())
  created  Int // 用户注册时间
  updated  Int? // 更新时间(密码修改/冻结时间)
  logged   Int? // 最后登录时间
  username String @unique // 登录名称(可以是用户名|邮箱|手机号码|QQ号码)
  password String // 用户的登录密码
  status   Int    @default(0) // 状态(0:未知,1:正常,2:已冻结)
}

// 系统用户会话
model pre_system_sessions {
  id      Int    @id @default(autoincrement())
  created Int
  updated Int? // 更新时间(登入/登出时间)
  logged  Int? // 最后登录时间
  token   String @unique
  user_id Int // 登录的用户id
  status  Int    @default(0) // 状态(0:未知,1:正常,2:已登出)

  @@index([user_id])
}

model pre_gjw_vpn_aeras {
  // VPN地区
  id    Int    @id
  title String // 地区
}

model pre_gjw_vpn_servers {
  // VPN服务器列表
  id            Int    @id
  area_id       Int // 地区
  type          String @default("hysteria2") //服务器类型，例如hysteria2
  server_ipaddr String // 服务器IP地址
  server_port   Int // 服务器端口号
  password      String // 密码
}

model pre_gjw_customers {
  // 客户列表
  id      Int     @id
  created Int
  updated Int?
  uid     Int
  name    String
  remark  String?

  @@index([uid])
  @@index([name])
}

model pre_gjw_customer_services {
  // 客户的服务列表
  id           Int  @id
  created      Int
  updated      Int?
  uid          Int // 操作人
  customer_id  Int // 客户编号
  area_id      Int // 地区
  status       Int  @default(0) //操作状态（0:未操作,1:开启,2:关闭,3:暂停）
  bandwidth    Int  @default(0) // 带宽兆数
  ipqty        Int  @default(0) // IP数量
  last_oper_id Int? // 最后的操作ID

  @@index([uid])
  @@index([customer_id])
  @@index([area_id])
  @@index([last_oper_id])
}

model pre_gjw_customer_service_opers {
  // 客户服务的操作申请
  id                  Int  @id
  created             Int
  updated             Int?
  uid                 Int
  customer_service_id Int // 操作的服务编号
  oper_status_from    Int // 操作前的状态
  oper_status_to      Int // 操作后的状态
  oper_bandwidth_from Int // 操作前的带宽兆数
  oper_bandwidth_to   Int // 操作后的带宽兆数
  oper_ipqty_from     Int // 操作前的IP数量
  oper_ipqty_to       Int // 操作后的IP数量
  status              Int  @default(0) //操作状态（0:未操作,1:待处理,2:处理中,3:处理成功,4:处理失败）

  @@index([uid])
  @@index([customer_service_id])
}

model pre_gjw_customer_service_vpns {
  // 客户的VPN列表
  id                  Int  @id
  created             Int
  updated             Int?
  uid                 Int // 操作人
  customer_service_id Int // 客户服务编号
  status              Int  @default(0) //操作状态（0:未操作,1:开启,2:关闭）
  vpn_server_id       Int? // 服务器编号
  last_oper_id        Int? // 最后的操作ID

  @@index([uid])
  @@index([customer_service_id])
  @@index([vpn_server_id])
}

model pre_gjw_customer_service_vpn_opers {
  // 客户VPN的操作申请
  id                       Int  @id
  created                  Int
  updated                  Int?
  customer_service_oper_id Int // 服务的操作编号
  customer_service_vpn_id  Int // VPN服务的编号
  oper_status_from         Int // 操作前的状态
  oper_status_to           Int // 操作后的状态
  oper_vpn_server_id_from  Int // 操作前的服务器ID
  oper_vpn_server_id_to    Int // 操作后的服务器ID
  status                   Int  @default(0) //操作状态（0:未操作,1:待处理,2:处理中,3:处理成功,4:处理失败）

  @@index([customer_service_oper_id])
  @@index([customer_service_vpn_id])
}
