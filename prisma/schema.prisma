generator client {
  provider        = "prisma-client-js"
  previewFeatures = ["driverAdapters"]
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model mails {
  id          Int     @id @default(autoincrement())
  created     Int
  domain_from String
  domain_to   String
  email_from  String
  email_to    String
  headers     String
  subject     String
  body_text   String?
  body_html   String?
}

model pre_system_menus {
  id        Int     @id @default(autoincrement())
  created   Int
  updated   Int?
  status    Int
  parent_id Int
  type      Int
  name      String
  title     String
  path      String?
  icon      String?
  component String?
  orderNo   Int
  keepalive Int
  redirect  String?
  meta      String?

  @@unique([parent_id, name])
}

// 系统配置
model pre_system_configs {
  id    Int    @id @default(autoincrement())
  name  String @unique
  value String // JSON格式存储
}

// 系统用户
model pre_system_users {
  id             Int    @id @default(autoincrement())
  created        Int // 用户注册时间
  updated        Int? // 更新时间(密码修改/冻结时间)
  logged         Int? // 最后登录时间
  login_name     String @unique // 登录名称(可以是用户名|邮箱|手机号码|QQ号码)
  login_password String // 用户的登录密码
  status         Int    @default(0) // 状态(0:未知,1:正常,2:已冻结)
  roles          String @default("user") // 用户所示角色组(user,admin)
}

// 系统用户会话
model pre_system_sessions {
  id      Int    @id @default(autoincrement())
  created Int
  updated Int? // 更新时间(登入/登出时间)
  logged  Int? // 最后登录时间
  token   String @unique
  user_id Int // 登录的用户id
  status  Int    @default(0) // 状态(0:未知,1:正常,2:已登出)

  @@index([user_id])
}

model pre_bee_logs {
  // 从bee系统下载的操作日志
  no            Int      @id
  customerid    String
  action        String
  oldvalue      String?
  newvalue      String?
  changeby      String?
  date          DateTime
  requestnumber String?
  remark        String?
  processed     Int      @default(0)

  @@index([processed])
}

model pre_bee_customer_nwsrvs {
  // 从bee系统下载的客户网络服务列表
  id              Int     @id @default(autoincrement())
  customerid      String  @unique
  customername    String?
  customername_cn String?
  status          String? // 状态
  ip_pcs          Int     @default(0) // IP数量
  download        String? // 下载带宽
  upload          String? // 上传带宽
  package         String? // 专线或共享
  ipservice       String? // IP服务地区
}

model pre_bee_customer_nwsrv_dates {
  // 客户网络服务按日期分类
  id         Int      @id @default(autoincrement())
  customerid String
  by_date    DateTime
  status     String? // 状态
  ip_pcs     Int      @default(0) // IP数量
  bw_dl_mbps Int? // 下载带宽
  bw_ul_mbps Int? // 上传带宽
  package    String? // 专线或共享
  ipservice  String? // IP服务地区

  @@unique([customerid, by_date])
}

model pre_bee_customer_nwsrv_prices {
  // 客户网络服务的价格
  id           Int    @id @default(autoincrement())
  customerid   String // 客户ID
  package      String // 专线或共享
  ipservice    String // IP服务地区
  bw_unitprice Int // 带宽单价
  ip_unitprice Int // IP单价

  @@unique([customerid, package, ipservice])
}

model pre_bee_customer_nwsrv_bills {
  // 客户网络服务的账单
  id         Int      @id @default(autoincrement())
  customerid String // 客户ID
  date_begin DateTime // 计费开始日期，格式为 "YYYY-MM-DD"
  date_end   DateTime // 计费结束日期，格式为 "YYYY-MM-DD"
  package    String // 专线或共享
  ipservice  String // IP服务地区
  bw_dl_mbps Int // 下载带宽
  bw_ul_mbps Int // 上传带宽
  ip_pcs     Int // IP数量

  @@index([customerid])
}
